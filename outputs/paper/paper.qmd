---
title: "Potential Factors of Decreasing Birth Rates in the US since the Great Recession and Beyond"
subtitle: "Reproduction of 'The Puzzle of Falling US Birth Rates since the Great Recession'(Kearney, Levine & Pardue, 2022)"
author: 
  - Chay Park
thanks: "Code and data are available at: https://github.com/Chay-HyunminPark/Social-Science-Study."
date: today
date-format: long
abstract: "Decreasing birth rates became the conversation topic globally in recent years. Kearney, Levine, and Pardue (2022) analyzed possible factors in demographical, economical and social aspects from the period 1980 to 2020. By reproducing some applications of the 'The Puzzle of Falling US Birth Rates Since the Great Recession,' this paper demonstrate potential factors correlating aspects on economics, religions, laws and enforcement applied in each states."
format: pdf
number-sections: true
bibliography: references.bib
prefer-html: true
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(palmerpenguins)
```


# Introduction
1) broader context to motivate
2) some detail about what the paper is about
3) a clear gap that needs to be filled
4) what was done
5) what was found
6) why it is important - replacement level fertility
7) the structure of the paper - 1. trend in US Birth Rates 2. Trends in Birth Rates by Population Subgroup 2.1 Five-year age group 2.2 Race and ethinicity 

In an economical aspect, birth rates are important factor that decides the growth of a country. 
The paper is about the factors that was not discussed in the Kearney's paper. They pointed out that as of 2007, the Great Recession, was the turning point of declining tendency in birth rates, however, it is beyond just demographical, economical, social and political factors. In this paper we will 

Over the 40 years,

According to the Centers for Disease Control and Prevention, birth rate is defined as "the number of live births per 1,000 population." It is calculated by dividing the number of live births in a population in a year by the midyear resident population. More specifically, for census years, rates are based on unrounded census counts of the resident population as of April 1. For the noncensus years 1981 - 1989, rates are based on the midyear resident population, rounded to thousands (National Center for Health Statistics 2023). In an economical aspect, birth rates are an important factor that decides the growth of a country. In recent years, low birth rate became a conversation topic both nation-wide and worldwide. Many countries are rising this issue of declining birth rates and posing alternative measures to compensate the population drop. For instance, 

* what was done, why and what was found, 3-4 paragraphs

We replicate the paper by Kearney, Levine, and Pardue (2022) with a focus on the following research questions: 

* What is the trend in the US birth rates over the period 1980 to 2020?

* How does the birth rates vary by the age group?

* How does the birth rates vary by the race and ethnicity of mothers'? 

The original code in the replication package is written in Stata. However, this paper utilizes R (R Core Team 2020) to analyze a dataset from the replication package. Packages such as ggplot2 (Wickham et al. 2016) for creating graphical representations, kableExtra (Zhu et al. 2021) for enhancing table aesthetics, and lubridate (Grolemund et al. 2021) for handling date-related operations were employed. Additionally, the Tidyverse framework (Wickham et al. 2019) ensures cohesiveness, while Dplyr (Wickham et al. 2021) facilitates data manipulation.

# Data {#sec-data}

## Methodology
The data for the trend in US Birth Rates, births per 1,000 women age 15-44 from the period 1980 to 2020 was acquired from CDC Vital Statistics Births Reports for 2015, 2019 and 2020 (Martin and Mathews 2017; Martin and Driscoll 2021; Hamilton and Osterman 2021). Another trends in Birth Rates by Population Subgroup, specifically birth rates by age group, race and ethnicity are again gathered from CDC Vital Statistics Births Reports. Original paper uses single-age population counts, among all races from 1969-2019 and by race and Hispanic origin from 1990-2019, from the CDC SEER database (CDC NCI 2021). Data is available freely at https://seer.cancer.gov/popdata/download.html and raw files can be found in the data/pop/folder of the original replication package.

## Features
From now on, every white refers to non-Hispanic, caucassian. Every black refers to non-Hispanic, African American. Hispanic refers to people with Hispanic ethinicity majority from south America. 


# Results
The results section should convey findings.
## Table, graph, table, graph

## Source
```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-bratetrend-graph
#| fig-cap: "Trend in US Birth Rates"


# Load necessary libraries
library(ggplot2)

# Set seed for reproducibility
set.seed(123)

# Read the data from CSV file
data <- read.csv(file = here::here("outputs/data/fig_1.csv"))

# Plotting the data
ggplot(data, aes(x = year, y = brate_all)) +
  geom_line(color = "blue") +
  geom_vline(xintercept = 2007, linetype = "dotted") +
  annotate("text", x = 2009, y = 70, label = "2007", vjust = -0.5, hjust = 0.5, color = "black") +
  geom_hline(yintercept = seq(50, 80, by = 5), color = "lightgrey") +
  scale_y_continuous(limits = c(50, 80), breaks = seq(50, 80, by = 5)) +
  scale_x_continuous(limits = c(1980, 2020), breaks = seq(1980, 2020, by = 1), labels = function(x) ifelse(x %% 5 == 0, x, "")) +
  labs(x = "Year", y = "Births per 1,000 women age 15-44",
       caption = "Source: Birth Rates collected from CDC Vital Statistics Births Reports for 2015, 2019, and 2020.") +
  theme_classic()
```

Figure 1 Trend in US Birth Rates, not just the Great Recession was there another events? 
abortion law, law enforcement dates, economic crisis other than great recession 

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-bratepop-graph
#| fig-cap: "Trends in Birth Rates by Population Subgroup"

# Load necessary libraries
library(ggplot2)
library(gridExtra)

# Set seed for reproducibility
set.seed(123)

# Read the data from CSV file
data <- read.csv(file = here::here("outputs/data/figs_2a_2b.csv"))

# Plotting the first line graph (Graph A)
graph_A <- ggplot(data, aes(x = year)) +
  geom_line(aes(y = brate_1519, color = "blue"), size = 0.4) +
  geom_line(aes(y = brate_2024, color = "orange"), size = 0.4) +
  geom_line(aes(y = brate_2529, color = "grey"), size = 0.4) +
  geom_line(aes(y = brate_3034, color = "yellow"), size = 0.4) +
  geom_line(aes(y = brate_3539, color = "cyan"), size = 0.4) +
  geom_line(aes(y = brate_4044, color = "green"), size = 0.4) +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_1519, label = "Age 15-19"), x = 1980, y = 60, hjust = -0.1, vjust = -0.5, size = 3, family = "Times") +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_2024, label = "Age 20-24"), x = 1980, y = 100, hjust = -0.1, vjust = -0.5, size = 3, family = "Times") +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_2529, label = "Age 25-29"), x = 1980, y = 125 , hjust = -0.1, vjust = -0.5, size = 3, family = "Times") +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_3034, label = "Age 30-34"), x = 1980, y = 80, hjust = -0.1, vjust = -0.5, size = 3, family = "Times") +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_3539, label = "Age 35-39"), x = 1980, y = 25, hjust = -0.1, vjust = -0.5, size = 3, family = "Times") +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_4044, label = "Age 40-44"), x = 1980, y = 5, hjust = -0.1, vjust = -0.5, size = 3, family = "Times") +
  geom_vline(xintercept = 2007, linetype = "dotted") +
  annotate("text", x = 2011, y = 122, label = "2007", vjust = -0.5, hjust = 0.5, color = "black", family = "Times") +
  geom_hline(yintercept = seq(0, 140, by = 20), color = "lightgrey") +
  scale_y_continuous(limits = c(0, 140), breaks = seq(0, 140, by = 20), labels = seq(0, 140, by = 20)) +
  scale_x_continuous(limits = c(1980, 2020), breaks = seq(1980, 2020, by = 1), labels = function(x) ifelse(x %% 5 == 0, x, "")) +
  labs(x = NULL, 
       y = 'Births per 1,000 women in relevant population subgroup',
       title = "A: Five-year age group",
       caption = NULL,
       family = "Times") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = -45, family = "Times", size = 8),
        plot.title = element_text(size = 10, family = "Times"),
        legend.position = "none")

# Plotting the second line graph (Graph B)
graph_B <- ggplot(data, aes(x = year)) +
  geom_line(aes(y = brate_hisp, color = "grey"), size = 0.4) +
  geom_line(aes(y = brate_blacknh, color = "orange"), size = 0.4) +
  geom_line(aes(y = brate_whitenh, color = "blue"), size = 0.4) +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_hisp, label = "Hispanic"), x = 1996, y = 110, size = 3, family = "Times") +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_blacknh, label = "Black, non-Hispanic"), x = 1998, y = 90, size = 3, family = "Times") +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_whitenh, label = "White, non-Hispanic"), x = 1998, y = 50, size = 3, family = "Times") +
  geom_vline(xintercept = 2007, linetype = "dotted") + annotate("text", x = 2010, y = 125, label = "2007", color = "black", family = "Times") +
  geom_hline(yintercept = seq(0, 140, by = 20), color = "lightgrey") + scale_y_continuous(limits = c(0, 140), breaks = seq(0, 140, by = 20), labels = seq(0, 140, by = 20)) + scale_x_continuous(limits = c(1990, 2020), breaks = seq(1990, 2020, by = 1), labels = function(x) ifelse(x %% 5 == 0, x, "")) + labs(x = NULL, y = NULL,
       title = "B: Race and ethnicity (ages 15-44)") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = -45, family = "Times", size = 8),
        plot.title = element_text(size = 10, family = "Times"),
        legend.position = "none")

# Arrange both graphs side by side
grid.arrange(graph_A, graph_B, nrow = 1)

```
Figure 2 A, abortion law applicable age ~,

Technology enhancement in medical field allows the abortion to be held more easily compared to 1980, 1990s. This change allow the young women who can afford the abortion or vice versa who can't afford giving birth to get the abortion. In the meantime, due to the advancement of technology, women at relatively old age can give the birth in their late 30s or even 40s. As well as change in child birth policy and health maintenance was eased compared to the old days in 1980s, 1990s, that promotes women at age older than 30 who are relatively financially stable have high willingness to give births, showing ascending pattern in birth rates over the 40 years. 

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: tbl-trendssub-table
#| tbl-cap: "Trends in Birth Rates by Population Race and Ethnicity"

# Load necessary libraries
library(dplyr)
library(knitr)
library(kableExtra)

# Read the data from CSV file
data <- read.csv(file = here::here("outputs/data/figs_2a_2b.csv"))

# Filter the data to include years starting from 1990
filtered_data <- data %>%
  filter(year >= 1990)

# Select the required columns and rename them
selected_data <- filtered_data %>%
  select(Year = year, White = brate_whitenh, Black = brate_blacknh, Hispanic = brate_hisp)

# Print the table using additional styling
kable(selected_data, caption = "Trends in Birth Rates by Population Race and Ethnicity (ages 15-44)", format = "html") %>%
  kable_styling(full_width = FALSE) %>%
  add_header_above(c("","Births per 1,000 women" = 3))

```

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-trendssub-graph
#| fig-cap: "Trends in Birth Rates by Population Race and Ethnicity"

# Load required libraries
library(dplyr)
library(ggplot2)

# Refer to the table a
# Assume selected_data contains the relevant data

# Create bar graphs for each racial/ethnic group
bar_plot <- ggplot(selected_data, aes(x = Year)) +
  geom_bar(aes(y = Hispanic, fill = "Hispanic"), stat = "identity", position = "stack") +
  geom_bar(aes(y = Black, fill = "Black"), stat = "identity", position = "stack") +
  geom_bar(aes(y = White, fill = "White"), stat = "identity", position = "stack") +
  labs(x = "Year",
       y = "Births per 1,000 women relevant population subgroup") +
  scale_fill_manual(values = c(Hispanic = "grey", Black = "orange", White = "blue"),
                    name = "Race and ethnicity") +
  theme_minimal() +
  scale_x_continuous(breaks = seq(1990, 2020, by = 5), minor_breaks = seq(1990, 2020, by = 1)) +
  ylim(0, 120)

# Print the bar plot
print(bar_plot)
```
Figure 3 B, major religion of Hispanic, Black, White  religious reason of each race and ethnicity.

Here we are dissecting the cultural and religious difference between the races among the population subgroup. 
Hispanic, majority catholic,
White, christian, catholic, etc
Black, christian, catholic, etc

It is prevailed that certain religion does not allow the abortion, saying that it disobey the words of God or whatever. 

-whether they accept the abortion or not, cultural perspectives, whether marriage affects the decision of keeping a child or not.<- financial reason 

Might include Map or not depending on the sources and references I find, see how long it'll gonna be.

# Discussion

In the discussion section, and any other relevant section, please be sure to discuss ethics and bias, with reference to relevant literature.

## Findings

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Ethical Implication

## Accounting for bias

## Limitation
Beginning in 1997, the birth rate for the maternal age group 45-49 includes data for mothers aged 45 and over in the numerator and is based on the population of women aged 45-49 in the denominator (National Center for Health Statistics 2023). However as the dataset is missing for the population of women aged 45-49 before 1997 and the paper counts the data from the period 1980 to 2020, the women population in the age group 45-49 is eliminated.

As mentioned in the original paper, the population subgroup can be diverged as they mix over the time. It is hard to sort out the race completely once they start to mixing it up. Therefore, over the time, we don't know the population subgroup Hispanic, Black, White are purely Hispanic, Black, White throughout the period. 

Also, we should not disregard the fact that for all statistical data, they always going to be a missing value that is not properly collected. A lot of people might not just report or illegally keep the population due to their illegal status in the US. 

Therefore, the data might be skewed due to aforementioned reasons. 

## Future Research
It might be interesting to expand the research worldwide, not just limiting ourselves into the US data. It is broadly known that Chinese and Indian population are growing exponentially while the birth rate in other developed countries continue to grow small. It might be interesting to research more what's behind. 

\newpage

# References

---
nocite: '@*'
---

