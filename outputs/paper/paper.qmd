---
title: "Potential Factors of Decreasing Birth Rates in the US since the Great Recession and Beyond"
subtitle: "Reproduction of 'The Puzzle of Falling US Birth Rates since the Great Recession'(Kearney, Levine & Pardue, 2022)"
author: 
  - Chay Park
thanks: "Code and data are available at: https://github.com/Chay-HyunminPark/Social-Science-Study."
date: today
date-format: long
abstract: "Decreasing birth rates became the conversation topic globally in recent years. Kearney, Levine, and Pardue (2022) analyzed possible factors in demographical, economical and social aspects from the period 1980 to 2020. By reproducing some applications of the 'The Puzzle of Falling US Birth Rates Since the Great Recession,' this paper demonstrate potential factors correlating aspects on economics, religions, laws and enforcement applied in each states."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(palmerpenguins)
```


# Introduction
1) broader context to motivate
2) some detail about what the paper is about
3) a clear gap that needs to be filled
4) what was done
5) what was found
6) why it is important - replacement level fertility
7) the structure of the paper - 1. trend in US Birth Rates 2. Trends in Birth Rates by Population Subgroup 2.1 Five-year age group 2.2 Race and ethinicity 

In an economical aspect, birth rates are important factor that decides the growth of a country. 
The paper is about the factors that was not discussed in the Kearney's paper. They pointed out that as of 2007, the Great Recession, was the turning point of declining tendency in birth rates, however, it is beyond just demographical, economical, social and political factors. In this paper we will 

Over the 40 years,

* what was done, why and what was found, 3-4 paragraphs

We replicate the paper by Kearney, Levine, and Pardue (2022) with a focus on the following research questions: 
- What is the trend in the US birth rates over the period 1980 to 2020?
- How does the birth rates vary by the age group?
- How does the birth rates vary by the race and ethnicity of mothers'? 

The original code in the replication package is written in Stata. However, this paper utilizes R (R Core Team 2020) to analyze a dataset from the replication package. Packages such as ggplot2 (Wickham et al. 2016) for creating graphical representations, kableExtra (Zhu et al. 2021) for enhancing table aesthetics, and lubridate (Grolemund et al. 2021) for handling date-related operations were employed. Additionally, the Tidyverse framework (Wickham et al. 2019) ensures cohesiveness, while Dplyr (Wickham et al. 2021) facilitates data manipulation.

# Data {#sec-data}

## Methodology
The data for the trend in US Birth Rates, births per 1,000 women age 15-44 from the period 1980 to 2020 was acquired from CDC Vital Statistics Births Reports for 2015, 2019 and 2020 (Martin and Mathews 2017; Martin and Driscoll 2021; Hamilton and Osterman 2021). Another trends in Birth Rates by Population Subgroup, specifically birth rates by age group, race and ethnicity are again gathered from CDC Vital Statistics Births Reports. Original paper uses single-age population counts, among all races from 1969-2019 and by race and Hispanic origin from 1990-2019, from the CDC SEER database (CDC NCI 2021). 

## Features
From now on, every white refers to non-Hispanic, caucassian. Every black refers to non-Hispanic, African American. Hispanic refers to people with Hispanic ethinicity majority from south America. 

# Results
The results section should convey findings.
## Table, graph, table, graph

## Source
```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-bratetrend-graph
#| fig-cap: "Trend in US Birth Rates"

# Load necessary libraries
library(ggplot2)

# Set seed for reproducibility
set.seed(123)

# Read the data from CSV file
data <- read.csv(file = here::here("outputs/data/fig_1.csv"))

# Plotting the data
ggplot(data, aes(x = year, y = brate_all)) +
  geom_line(color = "blue") +
  geom_vline(xintercept = 2007, linetype = "dotted") +
  annotate("text", x = 2007, y = 80, label = "2007", vjust = -0.5, hjust = 0.5, color = "black") +
  geom_hline(yintercept = seq(50, 80, by = 5), color = "lightgrey") +
  scale_y_continuous(limits = c(50, 80), breaks = seq(50, 80, by = 5)) +
  scale_x_continuous(limits = c(1980, 2020), breaks = seq(1980, 2020, by = 1), labels = function(x) ifelse(x %% 5 == 0, x, "")) +
  labs(x = "Year", y = "Births per 1,000 women age 15-44",
       title = "Trend in US Birth Rates",
       caption = "Birth Rates collected from CDC Vital Statistics Births Reports for 2015, 2019, and 2020.") +
  theme_classic()
```
Figure 1 Trend in US Birth Rates, not just the Great Recession was there another events? 
낙태법 시행일, 법적으로 진행된 일, economic crisis other than great recession 

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-bratepop-graph
#| fig-cap: "Trends in Birth Rates by Population Subgroup"

# Load necessary libraries
library(ggplot2)
library(gridExtra)

# Set seed for reproducibility
set.seed(123)

# Read the data from CSV file
data <- read.csv(file = here::here("outputs/data/figs_2a_2b.csv"))

# Plotting the first line graph (Graph A)
graph_A <- ggplot(data, aes(x = year)) +
  geom_line(aes(y = brate_1519, color = "blue"), size = 0.4) +
  geom_line(aes(y = brate_2024, color = "orange"), size = 0.4) +
  geom_line(aes(y = brate_2529, color = "grey"), size = 0.4) +
  geom_line(aes(y = brate_3034, color = "yellow"), size = 0.4) +
  geom_line(aes(y = brate_3539, color = "cyan"), size = 0.4) +
  geom_line(aes(y = brate_4044, color = "green"), size = 0.4) +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_1519, label = "Age 15-19"), hjust = -0.1, vjust = -0.5, size = 2, family = "Times") +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_2024, label = "Age 20-24"), hjust = -0.1, vjust = -0.5, size = 2, family = "Times") +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_2529, label = "Age 25-29"), hjust = -0.1, vjust = -0.5, size = 2, family = "Times") +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_3034, label = "Age 30-34"), hjust = -0.1, vjust = -0.5, size = 2, family = "Times") +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_3539, label = "Age 35-39"), hjust = -0.1, vjust = -0.5, size = 2, family = "Times") +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_4044, label = "Age 40-44"), hjust = -0.1, vjust = -0.5, size = 2, family = "Times") +
  geom_vline(xintercept = 2007, linetype = "dotted") +
  annotate("text", x = 2007, y = 120, label = "2007", vjust = -0.5, hjust = 0.5, color = "black", family = "Times") +
  geom_hline(yintercept = seq(0, 140, by = 20), color = "lightgrey") +
  scale_y_continuous(limits = c(0, 140), breaks = seq(0, 140, by = 20), labels = seq(0, 140, by = 20)) +
  scale_x_continuous(limits = c(1980, 2020), breaks = seq(1980, 2020, by = 1), labels = function(x) ifelse(x %% 5 == 0, x, "")) +
  labs(x = NULL, 
       y = 'Births per 1,000 women in relevant population subgroup',
       title = "A: Five-year age group",
       caption = NULL,
       family = "Times") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = -45, hjust = 1, family = "Times", size = 5),
        plot.title = element_text(size = 7, family = "Times"),
        legend.position = "none")

# Plotting the second line graph (Graph B)
graph_B <- ggplot(data, aes(x = year)) +
  geom_line(aes(y = brate_hisp, color = "grey"), size = 0.4) +
  geom_line(aes(y = brate_blacknh, color = "orange"), size = 0.4) +
  geom_line(aes(y = brate_whitenh, color = "blue"), size = 0.4) +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_hisp, label = "Hispanic"), size = 2, family = "Times") +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_blacknh, label = "Black, non-Hispanic"), size = 2, family = "Times") +
  geom_text(data = data[data$year == 2020,], aes(x = year, y = brate_whitenh, label = "White, non-Hispanic"), size = 2, family = "Times") +
  geom_vline(xintercept = 2007, linetype = "dotted") + annotate("text", x = 2007, y = 120, label = "2007", color = "black", family = "Times") +
  geom_hline(yintercept = seq(0, 140, by = 20), color = "lightgrey") + scale_y_continuous(limits = c(0, 140), breaks = seq(0, 140, by = 20), labels = seq(0, 140, by = 20)) + scale_x_continuous(limits = c(1990, 2020), breaks = seq(1990, 2020, by = 1), labels = function(x) ifelse(x %% 5 == 0, x, "")) + labs(x = NULL, y = NULL,
       title = "B: Race and ethnicity (ages 15-44)",
       caption = "Birth rates by age group, race, and ethnicity, and marital status gathered from CDC Vital Statistics Births Reports. Birth rates by Hispanic subpopulation, mother's education are calculated by the original author's using NCHS Vital Statistics birth micro data, SEER population data, and the Current Population Survey.") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = -45, hjust = 1, family = "Times", size = 5),
        plot.title = element_text(size = 7, family = "Times"),
        legend.position = "none")

# Arrange both graphs side by side
grid.arrange(graph_A, graph_B, nrow = 1)

```
Figure 2 A, 낙태법 적용 나이, 기술의 발전으로 인한 낙태 도입률, -> 경제적으로 안정되거나 아이의 부담을 지기 싫은 젊은 여성들은 낙태 ㅗ 기술의 발전으로 인한 건강 유지 및 출산 정책으로 인한 30세 이상의 경제적으로 안정된 여성들은 high willingness to give births, showing ascending pattern in birth rates over the 40 years. 

Figure 3 B, major religion of Hispanic, Black, White  religious reason of each race and ethnicity 

# 낙태법 적용 나이, 히스패닉과 아프리칸, 서양인들의 종교적 문화 차이-whether they accept the abortion or not, cultural perspectives, whether marriage affects the decision of keeping a child or not.<- financial reason 

Map

# Discussion

In the discussion section, and any other relevant section, please be sure to discuss ethics and bias, with reference to relevant literature.

## Findings

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Ethical Implication

## Accounting for bias

## Limitation

## Future Research

\newpage

# References
